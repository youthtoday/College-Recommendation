# 一、各相似度算法介绍

## 1. 皮尔逊相关系数
皮尔逊相关系数是衡量两个用户之间线性相关性最常用的统计学方法。
$$
Sim^{PCC}(u,v)=\frac{\sum_i(r_{u,i}-\overline{r_u})(r_{v,i}-\overline{r_v})}{\sqrt{\sum_i(r_{u,i}-\overline{r_u})^2}\sqrt{\sum_i(r_{v,i}-\overline{r_v})^2}}
$$

## 2. 斯皮尔曼相关系数
斯皮尔曼相关系数相当于用户评分为有秩序的级别时他们之间的皮尔逊相关系数。

对于大小为n的样本（本项目中n=95，为一个学校的学科评分数量），n个原始评分$r_{u,v}$，$r_{v,i}$被转换成秩序$R_{u,v}$，$R_{v,i}$。秩序转换的规则为：将原始数据按照降序进行排序，并依次转换为1，2，3等。如果遇到相同原始数据评分，则取他们所在的连续秩序值的平均数作为秩序。例如原始评分$r_{u,i}=[1,2,2,3]$，则秩序为$R_{v,i}=[4,2.5,2.5,1]$。
$$
Sim^{SCC}(u,v)=\frac{\sum_i(R_{u,i}-\overline{R_u})(R_{v,i}-\overline{R_v})}{\sqrt{\sum_i(R_{u,i}-\overline{R_u})^2}\sqrt{\sum_i(R_{v,i}-\overline{R_v})^2}}
$$

## 3. 余弦相似度
在统计学中，余弦相似度是两个数值序列之间相似性的度量。数值序列被看作是内积空间中的向量，余弦相似度被定义为它们之间夹角的余弦值，也就是向量的点积除以它们的长度之积。
$$
Sim^{Cosine}(u,v)=\frac{\sum^n_{i=1}r_{u,i}r_{v,i}}{\sqrt{\sum^n_{i=1}r^2_{u,i}}\sqrt{\sum^n_{i=1}r^2_{v,i}}}
$$

## 4. 欧几里得距离相似度
空间中两个向量之间的欧几里得距离是两端点之间直线段的长度。
$$
Sim^{Euclidean}(u,v)=\frac{1}{1+d(u,v)}
$$
$$
d(u,v)=\sqrt{\sum^n_{i=1}(r_{u,i}-r_{v,i})^2}
$$
## 5. 曼哈顿距离相似度
空间中两个向量之间的曼哈顿距离是两端点的笛卡尔坐标在各轴相减的绝对值之和。
$$
Sim^{Manhattan}(u,v)=\frac{1}{1+d(u,v)}
$$
$$
d(u,v)=\sum^n_{i=1}|{r_{u,i}-r_{v,i}}|
$$

## 6. 切比雪夫距离相似度
空间中两个向量之间的切比雪夫距离是两端点在任何坐标维度上的最大差异。
$$
Sim^{Che}(u,v)=\frac{1}{1+d(u,v)}
$$
$$
d(u,v)=max_{i\in I}(|r_{u,i}-r_{v,i}|)
$$

## 7. Quasi相似度
此方法不仅比基于余弦的或基于线性相关的相似度度量方法更好地利用了评级值，而且与基于欧氏距离的相似度度量方法相比，避免了对不同项的过分强调。
$$
Sim^{Quasi}(u,v)=\sum^n_{i=1}(1-\frac{|r_{u,i}-r_{v,i} |^p}{(r_{max}-r_{min})/2)^p})
$$

## 8. ITR相似度
它由两个部分组成：改进的三角形相似度和用户评级偏好URP。在实践中，改进的三角形相似度(ITR)不仅关注常见的评分，还考虑了用户的不寻常的评分。
$$
Sim^{ITR}(u,v)=Sim^{TRIANGLE^{,}}(u,v)*Sim^{URP}(u,v)
$$
$$
Sim^{TRIANGLE^{,}}(u,v)=1-\frac{\sqrt{\sum_i(r_{u,i}-r_{v,i})^2}}{\sqrt{\sum_ir_{u,i}^2}+\sqrt{\sum_ir_{v,i}^2}}
$$
$$
Sim^{URP}=1-\frac{1}{1+exp(-|\overline{r_u}-\overline{r_v}|*|\sigma_u-\sigma_v|)}
$$
$$
\sigma_u=\sqrt{\frac{\sum_i(r_{u,i}-\overline{r_u})^2}{|I_u|}}
$$

## 9. IPWR相似度
这个方法结合了一种基于皮尔逊相似度改进的相似度方法（被称为IPCC）与用户评分行为倾向（RPB）。
$$
Sim^{IPWR}(u,v)=\alpha*RPB(u,v)+\beta*Sim^{IPCC}(u,v)
$$
$$
RPB(u,v)=cos(|\overline{r_u}-\overline{r_v}|*|\sigma_u-\sigma_v|)
$$
$$
Sim^{IPCC}(u, v)=\frac{\sum_{i}\left[\left(r_{u, i} * \overline{r_{u}}\right)-\left(r_{u, i} * \overline{r_{i}}\right)\right] *\left[\left(r_{v, i} * \overline{r_{v}}\right)-\left(r_{v, i} * \bar{r}_{i}\right)\right]}{\sqrt{\sum_{i}\left[\left(r_{u, i} * \overline{r_{u}}\right)-\left(r_{u, i} * \overline{r_i}\right)\right]^{2}} \sqrt{\sum_{i}\left[\left(r_{v, i} * \overline{r_v}\right)-\left(r_{v, i} * \overline{r_i}\right)\right]^{2}}}
$$

## 10. ACSimi相似度
ACSimi利用传统的相似度计算方法和不相关项数来进行非对称构造。在该函数的定义中，有两个因子和一个相似函数。第一个部分，称为为一致性，用来衡量每个用户对其邻居的影响，反之亦然。而第二个部分，称为妥协，用来衡量项目数量的相似性，而不考虑项目评分。由于我们所使用的中国大学数据集没有缺失的评分项，ACSimi中第二个部分都会是一样的数值，所以本文将其默认为1。第三各部分是传统的相似度计算方法，可以为基于皮尔逊的、基于余弦的等算法。根据已有的实验和经验，第三部分使用皮尔逊相似度的效果最好。
$$
Sim^{AC}(u,v)=Sim^{Cosine}(u,v)*Sim^{PCC}(u,v)
$$

## 11. IER相似度
本项目为了克服欧几里得距离相似度方法的以上问题，即在MAE评价上的缺陷，提出了一种结合用户评分偏好的改进欧几里得距离相似度算法，全称是Improved Euclidean Distance Similarity with User Rating Preference，简称IER。
$$
Sim^{IER}=Sim^{URP}(u,v)*Sim^{Euclidean}(u,v)
$$

## 二、关联规则挖掘算法
专业推荐关联规则挖掘的原理是如果在一个学科下，有很多学校都同时开设了某几个专业，那么我们就可以认为这某几个专业相关。特别地，如果很多学校在开设了专业i的前提下还开设了专业j，那么我们可以认为专业j与专业i相关。关联规则是基于条件概率产生的。对于同一个学科的专业$M_i$和专业$M_j$，由专业$M_i$得到$M_j$存在关联的置信度（confidence）如下式所示。
$$
confidence(M_i⇒M_j)=P(M_i│M_j)=\frac{support\_count(M_i⋂M_j)}{support\_count(M_i)}
$$
$support\_count(M_i)$表示存在专业A的项集数量，$support\_count(M_i⋂M_j)$表示同时存在专业A和专业B的项集数量。

## 三、结合IER和关联规则挖掘的大学专业推荐
推荐大学-专业的实验目标是根据给定的大学和专业，给出推荐的大学及其专业。其实验原理是首先根据计算好的大学相似度，查找到相似度最高的学校群体（近邻数为n）作为候选大学集合。按照学校相似度，对学校相似度重新赋值为“学校秩序相似度”。秩序相似度计算公式如下，其基本思想是：按照原始相似度的升序顺序，依次赋予秩序比例。这种变换并不改变原始相似度的排序，如果某个学校原始相似度较大，其秩序比例仍然较大。如果包含n项元素的候选集合中某元素的原始相似度升序排名位置为第i项，那么赋予其秩序比例为i/n。
$$
Sim^{order(i)}=\frac{i}{n}
$$
如果存在几项元素的原始相似度排名位置相同，则统一将他们的秩序比例设置为不重复排名范围的平均值。比如有5个元素的原始相似度按升序排列为{0.3, 0.5, 0.5, 0.7, 0.8}，不重复升序排名秩序相似度为{1/5, 2/5, 3/5, 4/5, 1}，最终设置的秩序相似度为{1/5, 1/2, 1/2, 3/5, 4/5, 1}。
根据给定的专业判断其所属的一级学科，还需要计算近邻学校该学科的评分与给定学校该学科的评分之差d。将评分之差d按照下式进行变换。其变换目的是使变换后的值的升序即可表现为学科评分相似的升序。
$$
f(d)=\frac{1}{1+d}
$$
将大学学科差值相似度按照升序排名，使用式5-9即可得到其“学科秩序相似度”。最后使用“学校秩序相似度”和“学科秩序相似度”共同计算“学校-学科”对之间的相似度，
$$
pairSim((u,i),(v,i))=Sim^{order}(Sim(u,v))*Sim^{order}(d((u,i),(v,i)))
$$

